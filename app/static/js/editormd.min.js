/*
 * Editor.md
 *
 * @file        editormd.js 
 * @version     v1.5.0 
 * @description Open source online markdown editor.
 * @license     MIT License
 * @author      Pandao
 * {@link       https://github.com/pandao/editor.md}
 * @updateTime  2015-06-09
 */(function(f){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?module.exports=f:"function"===typeof define?define.amd||define(["jquery"],f):window.editormd=f()})(function(){var f="undefined"!==typeof jQuery?jQuery:Zepto;if("undefined"!==typeof f){var e=function(a,b){return new e.fn.init(a,b)};e.title=e.$name="Editor.md";e.version="1.5.0";e.homePage="https://pandao.github.io/editor.md/";e.classPrefix="editormd-";e.toolbarModes={full:"undo redo | bold del italic quote ucwords uppercase lowercase | h1 h2 h3 h4 h5 h6 | list-ul list-ol hr | link reference-link image code preformatted-text code-block table datetime emoji html-entities pagebreak | goto-line watch preview fullscreen clear search | help info".split(" "),simple:"undo redo | bold del italic quote uppercase lowercase | h1 h2 h3 h4 h5 h6 | list-ul list-ol hr | watch preview fullscreen | help info".split(" "),mini:"undo redo | watch preview | help info".split(" ")};e.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:!0,watch:!0,placeholder:"Enjoy Markdown! coding now...",gotoLine:!0,codeFold:!1,autoHeight:!1,autoFocus:!0,autoCloseTags:!0,searchReplace:!0,syncScrolling:!0,readOnly:!1,tabSize:4,indentUnit:4,lineNumbers:!0,lineWrapping:!0,autoCloseBrackets:!0,showTrailingSpace:!0,matchBrackets:!0,indentWithTabs:!0,styleSelectedText:!0,matchWordHighlight:!0,styleActiveLine:!0,dialogLockScreen:!0,dialogShowMask:!0,dialogDraggable:!0,dialogMaskBgColor:"#fff",dialogMaskOpacity:.1,fontSize:"13px",saveHTMLToTextarea:!1,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:!1,imageFormats:"jpg jpeg gif png bmp webp".split(" "),imageUploadURL:"",crossDomainUpload:!1,uploadCallbackURL:"",toc:!0,tocm:!1,tocTitle:"",tocDropdown:!1,tocContainer:"",tocStartLevel:1,htmlDecode:!1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0,toolbar:!0,toolbarAutoFixed:!0,toolbarIcons:"full",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return e.toolbarHandlers.ucwords},lowercase:function(){return e.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:'\x3ca href\x3d"javascript:;" title\x3d"Lowercase" unselectable\x3d"on"\x3e\x3ci class\x3d"fa" name\x3d"lowercase" style\x3d"font-size:24px;margin-top: -10px;"\x3ea\x3c/i\x3e\x3c/a\x3e',ucwords:'\x3ca href\x3d"javascript:;" title\x3d"ucwords" unselectable\x3d"on"\x3e\x3ci class\x3d"fa" name\x3d"ucwords" style\x3d"font-size:20px;margin-top: -3px;"\x3eAa\x3c/i\x3e\x3c/a\x3e'},toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:e.classPrefix+"bold",h2:e.classPrefix+"bold",h3:e.classPrefix+"bold",h4:e.classPrefix+"bold",h5:e.classPrefix+"bold",h6:e.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",help:"fa-question-circle",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"\u5f00\u6e90\u5728\u7ebfMarkdown\u7f16\u8f91\u5668\x3cbr/\x3eOpen source online Markdown editor.",tocTitle:"\u76ee\u5f55",toolbar:{undo:"\u64a4\u9500\uff08Ctrl+Z\uff09",redo:"\u91cd\u505a\uff08Ctrl+Y\uff09",bold:"\u7c97\u4f53",del:"\u5220\u9664\u7ebf",italic:"\u659c\u4f53",quote:"\u5f15\u7528",ucwords:"\u5c06\u6bcf\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u8f6c\u6210\u5927\u5199",uppercase:"\u5c06\u6240\u9009\u8f6c\u6362\u6210\u5927\u5199",lowercase:"\u5c06\u6240\u9009\u8f6c\u6362\u6210\u5c0f\u5199",h1:"\u6807\u98981",h2:"\u6807\u98982",h3:"\u6807\u98983",h4:"\u6807\u98984",h5:"\u6807\u98985",h6:"\u6807\u98986","list-ul":"\u65e0\u5e8f\u5217\u8868","list-ol":"\u6709\u5e8f\u5217\u8868",hr:"\u6a2a\u7ebf",link:"\u94fe\u63a5","reference-link":"\u5f15\u7528\u94fe\u63a5",image:"\u6dfb\u52a0\u56fe\u7247",code:"\u884c\u5185\u4ee3\u7801","preformatted-text":"\u9884\u683c\u5f0f\u6587\u672c / \u4ee3\u7801\u5757\uff08\u7f29\u8fdb\u98ce\u683c\uff09","code-block":"\u4ee3\u7801\u5757\uff08\u591a\u8bed\u8a00\u98ce\u683c\uff09",table:"\u6dfb\u52a0\u8868\u683c",datetime:"\u65e5\u671f\u65f6\u95f4",emoji:"Emoji\u8868\u60c5","html-entities":"HTML\u5b9e\u4f53\u5b57\u7b26",pagebreak:"\u63d2\u5165\u5206\u9875\u7b26","goto-line":"\u8df3\u8f6c\u5230\u884c",watch:"\u5173\u95ed\u5b9e\u65f6\u9884\u89c8",unwatch:"\u5f00\u542f\u5b9e\u65f6\u9884\u89c8",preview:"\u5168\u7a97\u53e3\u9884\u89c8HTML\uff08\u6309 Shift + ESC\u8fd8\u539f\uff09",fullscreen:"\u5168\u5c4f\uff08\u6309ESC\u8fd8\u539f\uff09",clear:"\u6e05\u7a7a",search:"\u641c\u7d22",help:"\u4f7f\u7528\u5e2e\u52a9",info:"\u5173\u4e8e"+e.title},buttons:{enter:"\u786e\u5b9a",cancel:"\u53d6\u6d88",close:"\u5173\u95ed"},dialog:{link:{title:"\u6dfb\u52a0\u94fe\u63a5",url:"\u94fe\u63a5\u5730\u5740",urlTitle:"\u94fe\u63a5\u6807\u9898",urlEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u94fe\u63a5\u5730\u5740\u3002"},referenceLink:{title:"\u6dfb\u52a0\u5f15\u7528\u94fe\u63a5",name:"\u5f15\u7528\u540d\u79f0",url:"\u94fe\u63a5\u5730\u5740",urlId:"\u94fe\u63a5ID",urlTitle:"\u94fe\u63a5\u6807\u9898",nameEmpty:"\u9519\u8bef\uff1a\u5f15\u7528\u94fe\u63a5\u7684\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002",idEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u5f15\u7528\u94fe\u63a5\u7684ID\u3002",urlEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u5f15\u7528\u94fe\u63a5\u7684URL\u5730\u5740\u3002"},image:{title:"\u6dfb\u52a0\u56fe\u7247",url:"\u56fe\u7247\u5730\u5740",link:"\u56fe\u7247\u94fe\u63a5",alt:"\u56fe\u7247\u63cf\u8ff0",uploadButton:"\u672c\u5730\u4e0a\u4f20",imageURLEmpty:"\u9519\u8bef\uff1a\u56fe\u7247\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a\u3002",uploadFileEmpty:"\u9519\u8bef\uff1a\u4e0a\u4f20\u7684\u56fe\u7247\u4e0d\u80fd\u4e3a\u7a7a\u3002",formatNotAllowed:"\u9519\u8bef\uff1a\u53ea\u5141\u8bb8\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6\uff0c\u5141\u8bb8\u4e0a\u4f20\u7684\u56fe\u7247\u6587\u4ef6\u683c\u5f0f\u6709\uff1a"},preformattedText:{title:"\u6dfb\u52a0\u9884\u683c\u5f0f\u6587\u672c\u6216\u4ee3\u7801\u5757",emptyAlert:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u9884\u683c\u5f0f\u6587\u672c\u6216\u4ee3\u7801\u7684\u5185\u5bb9\u3002"},codeBlock:{title:"\u6dfb\u52a0\u4ee3\u7801\u5757",selectLabel:"\u4ee3\u7801\u8bed\u8a00\uff1a",selectDefaultText:"\u8bf7\u9009\u62e9\u4ee3\u7801\u8bed\u8a00",otherLanguage:"\u5176\u4ed6\u8bed\u8a00",unselectedLanguageAlert:"\u9519\u8bef\uff1a\u8bf7\u9009\u62e9\u4ee3\u7801\u6240\u5c5e\u7684\u8bed\u8a00\u7c7b\u578b\u3002",codeEmptyAlert:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u4ee3\u7801\u5185\u5bb9\u3002"},htmlEntities:{title:"HTML \u5b9e\u4f53\u5b57\u7b26"},help:{title:"\u4f7f\u7528\u5e2e\u52a9"}}}};e.classNames={tex:e.classPrefix+"tex"};e.dialogZindex=99999;e.$katex=null;e.$marked=null;e.$CodeMirror=null;e.$prettyPrint=null;var u,w;e.prototype=e.fn={state:{watching:!1,loaded:!1,preview:!1,fullscreen:!1},init:function(a,b){b=b||{};"object"===typeof a&&(b=a);var c=this.classPrefix=e.classPrefix,d=this.settings=f.extend(!0,e.defaults,b);a="object"===typeof a?d.id:a;var k=this.editor=f("#"+a);this.id=a;this.lang=d.lang;var l=this.classNames={textarea:{html:c+"html-textarea",markdown:c+"markdown-textarea"}};d.pluginPath=""===d.pluginPath?d.path+"../plugins/":d.pluginPath;this.state.watching=d.watch?!0:!1;k.hasClass("editormd")||k.addClass("editormd");k.css({width:"number"===typeof d.width?d.width+"px":d.width,height:"number"===typeof d.height?d.height+"px":d.height});d.autoHeight&&k.css("height","auto");var h=this.markdownTextarea=k.children("textarea");1>h.length&&(k.append("\x3ctextarea\x3e\x3c/textarea\x3e"),h=this.markdownTextarea=k.children("textarea"));h.addClass(l.textarea.markdown).attr("placeholder",d.placeholder);"undefined"!==typeof h.attr("name")&&""!==h.attr("name")||h.attr("name",""!==d.name?d.name:a+"-markdown-doc");var g=[d.readOnly?"":'\x3ca href\x3d"javascript:;" class\x3d"fa fa-close '+c+'preview-close-btn"\x3e\x3c/a\x3e',d.saveHTMLToTextarea?'\x3ctextarea class\x3d"'+l.textarea.html+'" name\x3d"'+a+'-html-code"\x3e\x3c/textarea\x3e':"",'\x3cdiv class\x3d"'+c+'preview"\x3e\x3cdiv class\x3d"markdown-body '+c+'preview-container"\x3e\x3c/div\x3e\x3c/div\x3e','\x3cdiv class\x3d"'+c+'container-mask" style\x3d"display:block;"\x3e\x3c/div\x3e','\x3cdiv class\x3d"'+c+'mask"\x3e\x3c/div\x3e'].join("\n");k.append(g).addClass(c+"vertical");""!==d.theme&&k.addClass(c+"theme-"+d.theme);this.mask=k.children("."+c+"mask");this.containerMask=k.children("."+c+"container-mask");""!==d.markdown&&h.val(d.markdown);""!==d.appendMarkdown&&h.val(h.val()+d.appendMarkdown);this.htmlTextarea=k.children("."+l.textarea.html);this.preview=k.children("."+c+"preview");this.previewContainer=this.preview.children("."+c+"preview-container");""!==d.previewTheme&&this.preview.addClass(c+"preview-theme-"+d.previewTheme);"function"===typeof define&&define.amd&&("undefined"!==typeof katex&&(e.$katex=katex),d.searchReplace&&!d.readOnly&&(e.loadCSS(d.path+"codemirror/addon/dialog/dialog"),e.loadCSS(d.path+"codemirror/addon/search/matchesonscrollbar")));"function"===typeof define&&define.amd||!d.autoLoadModules?("undefined"!==typeof CodeMirror&&(e.$CodeMirror=CodeMirror),"undefined"!==typeof marked&&(e.$marked=marked),this.setCodeMirror().setToolbar().loadedDisplay()):this.loadQueues();return this},loadQueues:function(){var a=this,b=this.settings,c=b.path,d=function(){e.isIE8?a.loadedDisplay():b.flowChart||b.sequenceDiagram?e.loadScript(c+"raphael.min",function(){e.loadScript(c+"underscore.min",function(){!b.flowChart&&b.sequenceDiagram?e.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()}):b.flowChart&&!b.sequenceDiagram?e.loadScript(c+"flowchart.min",function(){e.loadScript(c+"jquery.flowchart.min",function(){a.loadedDisplay()})}):b.flowChart&&b.sequenceDiagram&&e.loadScript(c+"flowchart.min",function(){e.loadScript(c+"jquery.flowchart.min",function(){e.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()})})})})}):a.loadedDisplay()};e.loadCSS(c+"codemirror/codemirror.min");b.searchReplace&&!b.readOnly&&(e.loadCSS(c+"codemirror/addon/dialog/dialog"),e.loadCSS(c+"codemirror/addon/search/matchesonscrollbar"));b.codeFold&&e.loadCSS(c+"codemirror/addon/fold/foldgutter");e.loadScript(c+"codemirror/codemirror.min",function(){e.$CodeMirror=CodeMirror;e.loadScript(c+"codemirror/modes.min",function(){e.loadScript(c+"codemirror/addons.min",function(){a.setCodeMirror();if("gfm"!==b.mode&&"markdown"!==b.mode)return a.loadedDisplay(),!1;a.setToolbar();e.loadScript(c+"marked.min",function(){e.$marked=marked;b.previewCodeHighlight?e.loadScript(c+"prettify.min",function(){d()}):d()})})})});return this},setTheme:function(a){var b=this.classPrefix+"theme-";this.editor.removeClass(b+this.settings.theme).addClass(b+a);this.settings.theme=a;return this},setEditorTheme:function(a){var b=this.settings;b.editorTheme=a;"default"!==a&&e.loadCSS(b.path+"codemirror/theme/"+b.editorTheme);this.cm.setOption("theme",a);return this},setCodeMirrorTheme:function(a){this.setEditorTheme(a);return this},setPreviewTheme:function(a){var b=this.classPrefix+"preview-theme-";this.preview.removeClass(b+this.settings.previewTheme).addClass(b+a);this.settings.previewTheme=a;return this},setCodeMirror:function(){var a=this.settings,b=this.editor;"default"!==a.editorTheme&&e.loadCSS(a.path+"codemirror/theme/"+a.editorTheme);this.codeEditor=this.cm=e.$CodeMirror.fromTextArea(this.markdownTextarea[0],{mode:a.mode,theme:a.editorTheme,tabSize:a.tabSize,dragDrop:!1,autofocus:a.autoFocus,autoCloseTags:a.autoCloseTags,readOnly:a.readOnly?"nocursor":!1,indentUnit:a.indentUnit,lineNumbers:a.lineNumbers,lineWrapping:a.lineWrapping,extraKeys:{"Ctrl-Q":function(a){a.foldCode(a.getCursor())}},foldGutter:a.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:a.matchBrackets,indentWithTabs:a.indentWithTabs,styleActiveLine:a.styleActiveLine,styleSelectedText:a.styleSelectedText,autoCloseBrackets:a.autoCloseBrackets,showTrailingSpace:a.showTrailingSpace,highlightSelectionMatches:a.matchWordHighlight?{showToken:"onselected"===a.matchWordHighlight?!1:/\w/}:!1});this.codeMirror=this.cmElement=b.children(".CodeMirror");""!==a.value&&this.cm.setValue(a.value);this.codeMirror.css({fontSize:a.fontSize,width:a.watch?"50%":"100%"});a.autoHeight&&(this.codeMirror.css("height","auto"),this.cm.setOption("viewportMargin",Infinity));a.lineNumbers||this.codeMirror.find(".CodeMirror-gutters").css("border-right","none");return this},getCodeMirrorOption:function(a){return this.cm.getOption(a)},setCodeMirrorOption:function(a,b){this.cm.setOption(a,b);return this},addKeyMap:function(a,b){this.cm.addKeyMap(a,b);return this},removeKeyMap:function(a){this.cm.removeKeyMap(a);return this},gotoLine:function(a){var b=this.settings;if(!b.gotoLine)return this;var c=this.cm,d=c.lineCount(),e=this.preview;"string"===typeof a&&("last"===a&&(a=d),"first"===a&&(a=1));if("number"!==typeof a)return alert("Error: The line number must be an integer."),this;a=parseInt(a)-1;if(a>d)return alert("Error: The line number range 1-"+d),this;c.setCursor({line:a,ch:0});d=c.getScrollInfo().clientHeight;a=c.charCoords({line:a,ch:0},"local");c.scrollTo(null,(a.top+a.bottom-d)/2);if(b.watch){b=this.codeMirror.find(".CodeMirror-scroll")[0];a=f(b).height();var d=b.scrollTop,l=d/b.scrollHeight;0===d?e.scrollTop(0):d+a>=b.scrollHeight-16?e.scrollTop(e[0].scrollHeight):e.scrollTop(e[0].scrollHeight*l)}c.focus();return this},extend:function(a,b){"undefined"!==typeof b&&("function"===typeof b&&(b=f.proxy(b,this)),this[a]=b);"object"===typeof a&&"undefined"===typeof a.length&&f.extend(!0,this,a);return this},set:function(a,b){"undefined"!==typeof b&&"function"===typeof b&&(b=f.proxy(b,this));this[a]=b;return this},config:function(a,b){var c=this.settings;"object"===typeof a&&(c=f.extend(!0,c,a));"string"===typeof a&&(c[a]=b);this.settings=c;this.recreate();return this},on:function(a,b){var c=this.settings;"undefined"!==typeof c["on"+a]&&(c["on"+a]=f.proxy(b,this));return this},off:function(a){var b=this.settings;"undefined"!==typeof b["on"+a]&&(b["on"+a]=function(){});return this},showToolbar:function(a){var b=this.settings;if(b.readOnly)return this;b.toolbar&&(1>this.toolbar.length||""===this.toolbar.find("."+this.classPrefix+"menu").html())&&this.setToolbar();b.toolbar=!0;this.toolbar.show();this.resize();f.proxy(a||function(){},this)();return this},hideToolbar:function(a){this.settings.toolbar=!1;this.toolbar.hide();this.resize();f.proxy(a||function(){},this)();return this},setToolbarAutoFixed:function(a){var b=this.state,c=this.editor,d=this.toolbar,e=this.settings;"undefined"!==typeof a&&(e.toolbarAutoFixed=a);a=function(){var a=f(window),b=a.scrollTop();if(!e.toolbarAutoFixed)return!1;10<b-c.offset().top&&b<c.height()?d.css({position:"fixed",width:c.width()+"px",left:(a.width()-c.width())/2+"px"}):d.css({position:"absolute",width:"100%",left:0})};!b.fullscreen&&!b.preview&&e.toolbar&&e.toolbarAutoFixed&&f(window).bind("scroll",a);return this},setToolbar:function(){var a=this.settings;if(a.readOnly)return this;var b=this.editor,c=this.classPrefix,d=this.toolbar=b.children("."+c+"toolbar");a.toolbar&&1>d.length&&(b.append('\x3cdiv class\x3d"'+c+'toolbar"\x3e\x3cdiv class\x3d"'+c+'toolbar-container"\x3e\x3cul class\x3d"'+c+'menu"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e'),d=this.toolbar=b.children("."+c+"toolbar"));if(!a.toolbar)return d.hide(),this;d.show();for(var b="function"===typeof a.toolbarIcons?a.toolbarIcons():"string"===typeof a.toolbarIcons?e.toolbarModes[a.toolbarIcons]:a.toolbarIcons,d=d.find("."+this.classPrefix+"menu"),c="",f=!1,l=0,h=b.length;l<h;l++){var g=b[l];if("||"===g)f=!0;else if("|"===g)c+='\x3cli class\x3d"divider" unselectable\x3d"on"\x3e|\x3c/li\x3e';else{var m=/h(\d)/.test(g),p=g;"watch"!==g||a.watch||(p="unwatch");var q=a.lang.toolbar[p],n=a.toolbarIconTexts[p],p=a.toolbarIconsClass[p],q="undefined"===typeof q?"":q,n="undefined"===typeof n?"":n,p="undefined"===typeof p?"":p,r=f?'\x3cli class\x3d"pull-right"\x3e':"\x3cli\x3e";"undefined"!==typeof a.toolbarCustomIcons[g]&&"function"!==typeof a.toolbarCustomIcons[g]?r+=a.toolbarCustomIcons[g]:(r+='\x3ca href\x3d"javascript:;" title\x3d"'+q+'" unselectable\x3d"on"\x3e',r+='\x3ci class\x3d"fa '+p+'" name\x3d"'+g+'" unselectable\x3d"on"\x3e'+(m?g.toUpperCase():""===p?n:"")+"\x3c/i\x3e",r+="\x3c/a\x3e");r+="\x3c/li\x3e";c=f?r+c:c+r}}d.html(c);d.find('[title\x3d"Lowercase"]').attr("title",a.lang.toolbar.lowercase);d.find('[title\x3d"ucwords"]').attr("title",a.lang.toolbar.ucwords);this.setToolbarHandler();this.setToolbarAutoFixed();return this},dialogLockScreen:function(){f.proxy(e.dialogLockScreen,this)();return this},dialogShowMask:function(a){f.proxy(e.dialogShowMask,this)(a);return this},getToolbarHandles:function(a){var b=this.toolbarHandlers=e.toolbarHandlers;return a&&"undefined"!==typeof toolbarIconHandlers[a]?b[a]:b},setToolbarHandler:function(){var a=this,b=this.settings;if(!b.toolbar||b.readOnly)return this;var c=this.cm,d=this.toolbarIcons=this.toolbar.find("."+this.classPrefix+"menu \x3e li \x3e a"),k=this.getToolbarHandles();d.bind(e.mouseOrTouch("click","touchend"),function(d){d=f(this).children(".fa");var e=d.attr("name"),g=c.getCursor(),l=c.getSelection();if(""!==e)return a.activeIcon=d,"undefined"!==typeof k[e]?f.proxy(k[e],a)(c):"undefined"!==typeof b.toolbarHandlers[e]&&f.proxy(b.toolbarHandlers[e],a)(c,d,g,l),"link"!==e&&"reference-link"!==e&&"image"!==e&&"code-block"!==e&&"preformatted-text"!==e&&"watch"!==e&&"preview"!==e&&"search"!==e&&"fullscreen"!==e&&"info"!==e&&c.focus(),!1});return this},createDialog:function(a){return f.proxy(e.createDialog,this)(a)},createInfoDialog:function(){var a=this,b=this.editor,c=this.classPrefix,d=['\x3cdiv class\x3d"'+c+"dialog "+c+'dialog-info" style\x3d""\x3e','\x3cdiv class\x3d"'+c+'dialog-container"\x3e','\x3ch1\x3e\x3ci class\x3d"editormd-logo editormd-logo-lg editormd-logo-color"\x3e\x3c/i\x3e '+e.title+"\x3csmall\x3ev"+e.version+"\x3c/small\x3e\x3c/h1\x3e","\x3cp\x3e"+this.lang.description+"\x3c/p\x3e",'\x3cp style\x3d"margin: 10px 0 20px 0;"\x3e\x3ca href\x3d"'+e.homePage+'" target\x3d"_blank"\x3e'+e.homePage+' \x3ci class\x3d"fa fa-external-link"\x3e\x3c/i\x3e\x3c/a\x3e\x3c/p\x3e','\x3cp style\x3d"font-size: 0.85em;"\x3eCopyright \x26copy; 2015 \x3ca href\x3d"https://github.com/pandao" target\x3d"_blank" class\x3d"hover-link"\x3ePandao\x3c/a\x3e, The \x3ca href\x3d"https://github.com/pandao/editor.md/blob/master/LICENSE" target\x3d"_blank" class\x3d"hover-link"\x3eMIT\x3c/a\x3e License.\x3c/p\x3e\n\x3c/div\x3e','\x3ca href\x3d"javascript:;" class\x3d"fa fa-close '+c+'dialog-close"\x3e\x3c/a\x3e',"\x3c/div\x3e"].join("\n");b.append(d);b=this.infoDialog=b.children("."+c+"dialog-info");b.find("."+c+"dialog-close").bind(e.mouseOrTouch("click","touchend"),function(){a.hideInfoDialog()});b.css("border",e.isIE8?"1px solid #ddd":"").css("z-index",e.dialogZindex).show();this.infoDialogPosition();return this},infoDialogPosition:function(){var a=this.infoDialog,b=function(){a.css({top:(f(window).height()-a.height())/2+"px",left:(f(window).width()-a.width())/2+"px"})};b();f(window).resize(b);return this},showInfoDialog:function(){f("html,body").css("overflow-x","hidden");var a=this.settings,b=this.infoDialog=this.editor.children("."+this.classPrefix+"dialog-info");1>b.length&&this.createInfoDialog();this.lockScreen(!0);this.mask.css({opacity:a.dialogMaskOpacity,backgroundColor:a.dialogMaskBgColor}).show();b.css("z-index",e.dialogZindex).show();this.infoDialogPosition();return this},hideInfoDialog:function(){f("html,body").css("overflow-x","");this.infoDialog.hide();this.mask.hide();this.lockScreen(!1);return this},lockScreen:function(a){e.lockScreen(a);this.resize();return this},recreate:function(){var a=this.editor,b=this.settings;this.codeMirror.remove();this.setCodeMirror();b.readOnly||(0<a.find(".editormd-dialog").length&&a.find(".editormd-dialog").remove(),b.toolbar&&(this.getToolbarHandles(),this.setToolbar()));this.loadedDisplay(!0);return this},previewCodeHighlight:function(){var a=this.previewContainer;this.settings.previewCodeHighlight&&(a.find("pre").addClass("prettyprint linenums"),"undefined"!==typeof prettyPrint&&prettyPrint());return this},katexRender:function(){if(null===u)return this;this.previewContainer.find("."+e.classNames.tex).each(function(){var a=f(this);e.$katex.render(a.text(),a[0]);a.find(".katex").css("font-size","1.6em")});return this},flowChartAndSequenceDiagramRender:function(){var a=this.settings,b=this.previewContainer;if(e.isIE8)return this;if(a.flowChart){if(null===w)return this;b.find(".flowchart").flowChart()}a.sequenceDiagram&&b.find(".sequence-diagram").sequenceDiagram({theme:"simple"});var a=this.preview,b=this.codeMirror.find(".CodeMirror-scroll"),c=b.height(),d=b.scrollTop(),k=d/b[0].scrollHeight,l=0;a.find(".markdown-toc-list").each(function(){l+=f(this).height()});var h=a.find(".editormd-toc-menu").height(),h=h?h:0;0===d?a.scrollTop(0):d+c>=b[0].scrollHeight-16?a.scrollTop(a[0].scrollHeight):a.scrollTop((a[0].scrollHeight+l+h)*k);return this},registerKeyMaps:function(a){var b=this,c=this.cm,d=e.toolbarHandlers,k=this.settings.disabledKeyMaps;if(a=a||null)for(var l in a)0>f.inArray(l,k)&&c.addKeyMap(a);else{for(var h in e.keyMaps)a=e.keyMaps[h],a="string"===typeof a?f.proxy(d[a],b):f.proxy(a,b),0>f.inArray(h,["F9","F10","F11"])&&0>f.inArray(h,k)&&(l={},l[h]=a,c.addKeyMap(l));f(window).keydown(function(a){if(0>f.inArray({120:"F9",121:"F10",122:"F11"}[a.keyCode],k))switch(a.keyCode){case 120:return f.proxy(d.watch,b)(),!1;case 121:return f.proxy(d.preview,b)(),!1;case 122:return f.proxy(d.fullscreen,b)(),!1}})}return this},bindScrollEvent:function(){var a=this,b=this.preview,c=this.settings,d=this.codeMirror,k=e.mouseOrTouch;if(!c.syncScrolling)return this;var l=function(){d.find(".CodeMirror-scroll").bind(k("scroll","touchmove"),function(d){var e=f(this).height(),k=f(this).scrollTop(),g=k/f(this)[0].scrollHeight,h=0;b.find(".markdown-toc-list").each(function(){h+=f(this).height()});var v=b.find(".editormd-toc-menu").height(),v=v?v:0;0===k?b.scrollTop(0):k+e>=f(this)[0].scrollHeight-16?b.scrollTop(b[0].scrollHeight):b.scrollTop((b[0].scrollHeight+h+v)*g);f.proxy(c.onscroll,a)(d)})},h=function(){d.find(".CodeMirror-scroll").unbind(k("scroll","touchmove"))},g=function(){b.bind(k("scroll","touchmove"),function(b){var e=f(this).height(),k=f(this).scrollTop(),g=k/f(this)[0].scrollHeight,h=d.find(".CodeMirror-scroll");0===k?h.scrollTop(0):k+e>=f(this)[0].scrollHeight?h.scrollTop(h[0].scrollHeight):h.scrollTop(h[0].scrollHeight*g);f.proxy(c.onpreviewscroll,a)(b)})},m=function(){b.unbind(k("scroll","touchmove"))};d.bind({mouseover:l,mouseout:h,touchstart:l,touchend:h});if("single"===c.syncScrolling)return this;b.bind({mouseover:g,mouseout:m,touchstart:g,touchend:m});return this},bindChangeEvent:function(){var a=this,b=this.settings;if(!b.syncScrolling)return this;this.cm.on("change",function(c,d){b.watch&&a.previewContainer.css("padding",b.autoHeight?"20px 20px 50px 40px":"20px");u=setTimeout(function(){clearTimeout(u);a.save();u=null},b.delay)});return this},loadedDisplay:function(a){a=a||!1;var b=this,c=this.editor,d=this.preview,e=this.settings;this.containerMask.hide();this.save();e.watch&&d.show();c.data("oldWidth",c.width()).data("oldHeight",c.height());this.resize();this.registerKeyMaps();f(window).resize(function(){b.resize()});this.bindScrollEvent().bindChangeEvent();a||f.proxy(e.onload,this)();this.state.loaded=!0;return this},width:function(a){this.editor.css("width","number"===typeof a?a+"px":a);this.resize();return this},height:function(a){this.editor.css("height","number"===typeof a?a+"px":a);this.resize();return this},resize:function(a,b){a=a||null;b=b||null;var c=this.state,d=this.editor,e=this.preview,l=this.toolbar,h=this.settings,g=this.codeMirror;a&&d.css("width","number"===typeof a?a+"px":a);!h.autoHeight||c.fullscreen||c.preview?(b&&d.css("height","number"===typeof b?b+"px":b),c.fullscreen&&d.height(f(window).height()),h.toolbar&&!h.readOnly?g.css("margin-top",l.height()+1).height(d.height()-l.height()):g.css("margin-top",0).height(d.height())):(d.css("height","auto"),g.css("height","auto"));h.watch?(g.width(d.width()/2),e.width(c.preview?d.width():d.width()/2),this.previewContainer.css("padding",h.autoHeight?"20px 20px 50px 40px":"20px"),h.toolbar&&!h.readOnly?e.css("top",l.height()+1):e.css("top",0),!h.autoHeight||c.fullscreen||c.preview?(d=h.toolbar&&!h.readOnly?d.height()-l.height():d.height(),e.height(d)):e.height("")):(g.width(d.width()),e.hide());c.loaded&&f.proxy(h.onresize,this)();return this},save:function(){if(null===u)return this;var a=this,b=this.state,c=this.settings,d=this.cm,k=d.getValue(),l=this.previewContainer;if("gfm"!==c.mode&&"markdown"!==c.mode)return this.markdownTextarea.val(k),this;var h=e.$marked,g=this.markdownToC=[],m=this.markedRendererOptions={toc:c.toc,tocm:c.tocm,tocStartLevel:c.tocStartLevel,pageBreak:c.pageBreak,taskList:c.taskList,emoji:c.emoji,tex:c.tex,atLink:c.atLink,emailLink:c.emailLink,flowChart:c.flowChart,sequenceDiagram:c.sequenceDiagram,previewCodeHighlight:c.previewCodeHighlight},m=this.markedOptions={renderer:e.markedRenderer(g,m),gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:c.htmlDecode?!1:!0,smartLists:!0,smartypants:!0};h.setOptions(m);h=e.$marked(k,m);h=e.filterHTMLTags(h,c.htmlDecode);this.markdownTextarea.text(k);d.save();c.saveHTMLToTextarea&&this.htmlTextarea.text(h);if(c.watch||!c.watch&&b.preview){l.html(h);this.previewCodeHighlight();c.toc&&(d=""===c.tocContainer?l:f(c.tocContainer),k=d.find("."+this.classPrefix+"toc-menu"),d.attr("previewContainer",""===c.tocContainer?"true":"false"),""!==c.tocContainer&&0<k.length&&k.remove(),e.markdownToCRenderer(g,d,c.tocDropdown,c.tocStartLevel),(c.tocDropdown||0<d.find("."+this.classPrefix+"toc-menu").length)&&e.tocDropdownMenu(d,""!==c.tocTitle?c.tocTitle:this.lang.tocTitle),""!==c.tocContainer&&l.find(".markdown-toc").css("border","none"));c.tex&&(!e.kaTeXLoaded&&c.autoLoadModules?e.loadKaTeX(function(){e.$katex=katex;e.kaTeXLoaded=!0;a.katexRender()}):(e.$katex=katex,this.katexRender()));if(c.flowChart||c.sequenceDiagram)w=setTimeout(function(){clearTimeout(w);a.flowChartAndSequenceDiagramRender();w=null},10);b.loaded&&f.proxy(c.onchange,this)()}return this},focus:function(){this.cm.focus();return this},setCursor:function(a){this.cm.setCursor(a);return this},getCursor:function(){return this.cm.getCursor()},setSelection:function(a,b){this.cm.setSelection(a,b);return this},getSelection:function(){return this.cm.getSelection()},setSelections:function(a){this.cm.setSelections(a);return this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(a){this.cm.replaceSelection(a);return this},insertValue:function(a){this.replaceSelection(a);return this},appendMarkdown:function(a){var b=this.cm;b.setValue(b.getValue()+a);return this},setMarkdown:function(a){this.cm.setValue(a||this.settings.markdown);return this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(a){this.cm.setValue(a);return this},clear:function(){this.cm.setValue("");return this},getHTML:function(){return this.settings.saveHTMLToTextarea?this.htmlTextarea.val():(alert("Error: settings.saveHTMLToTextarea \x3d\x3d false"),!1)},getTextareaSavedHTML:function(){return this.getHTML()},getPreviewedHTML:function(){return this.settings.watch?this.previewContainer.html():(alert("Error: settings.watch \x3d\x3d false"),!1)},watch:function(a){var b=this.settings;if(0>f.inArray(b.mode,["gfm","markdown"]))return this;this.state.watching=b.watch=!0;this.preview.show();if(this.toolbar){var c=b.toolbarIconsClass.watch,d=b.toolbarIconsClass.unwatch,e=this.toolbar.find(".fa[name\x3dwatch]");e.parent().attr("title",b.lang.toolbar.watch);e.removeClass(d).addClass(c)}this.codeMirror.css("border-right","1px solid #ddd").width(this.editor.width()/2);u=0;this.save().resize();b.onwatch||(b.onwatch=a||function(){});f.proxy(b.onwatch,this)();return this},unwatch:function(a){var b=this.settings;this.state.watching=b.watch=!1;this.preview.hide();if(this.toolbar){var c=b.toolbarIconsClass.watch,d=b.toolbarIconsClass.unwatch,e=this.toolbar.find(".fa[name\x3dwatch]");e.parent().attr("title",b.lang.toolbar.unwatch);e.removeClass(c).addClass(d)}this.codeMirror.css("border-right","none").width(this.editor.width());this.resize();b.onunwatch||(b.onunwatch=a||function(){});f.proxy(b.onunwatch,this)();return this},show:function(a){a=a||function(){};var b=this;this.editor.show(0,function(){f.proxy(a,b)()});return this},hide:function(a){a=a||function(){};var b=this;this.editor.hide(0,function(){f.proxy(a,b)()});return this},previewing:function(){var a=this,b=this.editor,c=this.preview,d=this.toolbar,k=this.settings,l=this.codeMirror,h=this.previewContainer;if(0>f.inArray(k.mode,["gfm","markdown"]))return this;k.toolbar&&d&&(d.toggle(),d.find(".fa[name\x3dpreview]").toggleClass("active"));l.toggle();d=function(b){b.shiftKey&&27===b.keyCode&&a.previewed()};"none"===l.css("display")?(this.state.preview=!0,this.state.fullscreen&&c.css("background","#fff"),b.find("."+this.classPrefix+"preview-close-btn").show().bind(e.mouseOrTouch("click","touchend"),function(){a.previewed()}),k.watch?h.css("padding",""):this.save(),h.addClass(this.classPrefix+"preview-active"),c.show().css({position:"",top:0,width:b.width(),height:k.autoHeight&&!this.state.fullscreen?"auto":b.height()}),this.state.loaded&&f.proxy(k.onpreviewing,this)(),f(window).bind("keyup",d)):(f(window).unbind("keyup",d),this.previewed())},previewed:function(){var a=this.editor,b=this.preview,c=this.toolbar,d=this.settings,k=this.previewContainer,l=a.find("."+this.classPrefix+"preview-close-btn");this.state.preview=!1;this.codeMirror.show();d.toolbar&&c.show();b[d.watch?"show":"hide"]();l.hide().unbind(e.mouseOrTouch("click","touchend"));k.removeClass(this.classPrefix+"preview-active");d.watch&&k.css("padding","20px");b.css({background:null,position:"absolute",width:a.width()/2,height:d.autoHeight&&!this.state.fullscreen?"auto":a.height()-c.height(),top:d.toolbar?c.height():0});this.state.loaded&&f.proxy(d.onpreviewed,this)();return this},fullscreen:function(){var a=this,b=this.state,c=this.editor,d=this.toolbar,e=this.settings,l=this.classPrefix+"fullscreen";d&&d.find(".fa[name\x3dfullscreen]").parent().toggleClass("active");d=function(c){c.shiftKey||27!==c.keyCode||b.fullscreen&&a.fullscreenExit()};c.hasClass(l)?(f(window).unbind("keyup",d),this.fullscreenExit()):(b.fullscreen=!0,f("html,body").css("overflow","hidden"),c.css({width:f(window).width(),height:f(window).height()}).addClass(l),this.resize(),f.proxy(e.onfullscreen,this)(),f(window).bind("keyup",d));return this},fullscreenExit:function(){var a=this.editor,b=this.settings,c=this.toolbar,d=this.classPrefix+"fullscreen";this.state.fullscreen=!1;c&&c.find(".fa[name\x3dfullscreen]").parent().removeClass("active");f("html,body").css("overflow","");a.css({width:a.data("oldWidth"),height:a.data("oldHeight")}).removeClass(d);this.resize();f.proxy(b.onfullscreenExit,this)();return this},executePlugin:function(a,b){var c=this,d=this.cm;b=this.settings.pluginPath+b;if("function"===typeof define){if("undefined"===typeof this[a])return alert("Error: "+a+" plugin is not found, you are not load this plugin."),this;this[a](d);return this}0>f.inArray(b,e.loadFiles.plugin)?e.loadPlugin(b,function(){e.loadPlugins[a]=c[a];c[a](d)}):f.proxy(e.loadPlugins[a],this)(d);return this},search:function(a){var b=this.settings;if(!b.searchReplace)return alert("Error: settings.searchReplace \x3d\x3d false"),this;b.readOnly||this.cm.execCommand(a||"find");return this},searchReplace:function(){this.search("replace");return this},searchReplaceAll:function(){this.search("replaceAll");return this}};e.fn.init.prototype=e.fn;e.dialogLockScreen=function(){(this.settings||{dialogLockScreen:!0}).dialogLockScreen&&(f("html,body").css("overflow","hidden"),this.resize())};e.dialogShowMask=function(a){var b=this.editor,c=this.settings||{dialogShowMask:!0};a.css({top:(f(window).height()-a.height())/2+"px",left:(f(window).width()-a.width())/2+"px"});c.dialogShowMask&&b.children("."+this.classPrefix+"mask").css("z-index",parseInt(a.css("z-index"))-1).show()};e.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("**"+c+"**");""===c&&a.setCursor(b.line,b.ch+2)},del:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("~~"+c+"~~");""===c&&a.setCursor(b.line,b.ch+2)},italic:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("*"+c+"*");""===c&&a.setCursor(b.line,b.ch+1)},quote:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("\x3e "+c),a.setCursor(b.line,b.ch+2)):a.replaceSelection("\x3e "+c)},ucfirst:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(e.firstUpperCase(b));a.setSelections(c)},ucwords:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(e.wordsFirstUpperCase(b));a.setSelections(c)},uppercase:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(b.toUpperCase());a.setSelections(c)},lowercase:function(){var a=this.cm;a.getCursor();var b=a.getSelection(),c=a.listSelections();a.replaceSelection(b.toLowerCase());a.setSelections(c)},h1:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("# "+c),a.setCursor(b.line,b.ch+2)):a.replaceSelection("# "+c)},h2:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("## "+c),a.setCursor(b.line,b.ch+3)):a.replaceSelection("## "+c)},h3:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("### "+c),a.setCursor(b.line,b.ch+4)):a.replaceSelection("### "+c)},h4:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("#### "+c),a.setCursor(b.line,b.ch+5)):a.replaceSelection("#### "+c)},h5:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("##### "+c),a.setCursor(b.line,b.ch+6)):a.replaceSelection("##### "+c)},h6:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("###### "+c),a.setCursor(b.line,b.ch+7)):a.replaceSelection("###### "+c)},"list-ul":function(){var a=this.cm;a.getCursor();var b=a.getSelection();if(""===b)a.replaceSelection("- "+b);else{for(var b=b.split("\n"),c=0,d=b.length;c<d;c++)b[c]=""===b[c]?"":"- "+b[c];a.replaceSelection(b.join("\n"))}},"list-ol":function(){var a=this.cm;a.getCursor();var b=a.getSelection();if(""===b)a.replaceSelection("1. "+b);else{for(var b=b.split("\n"),c=0,d=b.length;c<d;c++)b[c]=""===b[c]?"":c+1+". "+b[c];a.replaceSelection(b.join("\n"))}},hr:function(){var a=this.cm,b=a.getCursor();a.getSelection();a.replaceSelection((0!==b.ch?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex)return alert("settings.tex \x3d\x3d\x3d false"),this;var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("$$"+c+"$$");""===c&&a.setCursor(b.line,b.ch+2)},link:function(){this.executePlugin("linkDialog","link-dialog/link-dialog")},"reference-link":function(){this.executePlugin("referenceLinkDialog","reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak)return alert("settings.pageBreak \x3d\x3d\x3d false"),this;var a=this.cm;a.getSelection();a.replaceSelection("\r\n[\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d]\r\n")},image:function(){this.executePlugin("imageDialog","image-dialog/image-dialog")},code:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("`"+c+"`");""===c&&a.setCursor(b.line,b.ch+1)},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var a=this.cm;a.getSelection();var b=this.settings.lang.name,b=e.dateFormat()+" "+e.dateFormat("zh-cn"===b||"zh-tw"===b?"cn-week-day":"week-day");a.replaceSelection(b)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog","html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},info:function(){this.showInfoDialog()}};e.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();this.settings.emoji?(a.replaceSelection(":"+c+":"),""===c&&a.setCursor(b.line,b.ch+1)):alert("Error: settings.emoji \x3d\x3d false")},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("["+c+"]("+(""===c?"":' "'+c+'"')+")");""===c&&a.setCursor(b.line,b.ch+1)},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();this.settings.atLink?(a.replaceSelection("@"+c),""===c&&a.setCursor(b.line,b.ch+1)):alert("Error: settings.atLink \x3d\x3d false")},"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection(["```",c,"```"].join("\n"));""===c&&a.setCursor(b.line,b.ch+3)},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("!["+c+"]("+(""===c?"":' "'+c+'"')+")");""===c&&a.setCursor(b.line,b.ch+4)},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol","Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak",F9:"watch",F10:"preview",F11:"fullscreen"};var x=function(a){return String.prototype.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};e.trim=x;e.ucwords=e.wordsFirstUpperCase=function(a){return a.toLowerCase().replace(/\b(\w)|\s(\w)/g,function(a){return a.toUpperCase()})};e.firstUpperCase=e.ucfirst=function(a){return a.toLowerCase().replace(/\b(\w)/,function(a){return a.toUpperCase()})};e.urls={atLinkBase:"https://github.com/"};e.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\.\_]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/};e.emoji={path:"http://www.emoji-cheat-sheet.com/graphics/emojis/",ext:".png"};e.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"};e.markedRenderer=function(a,b){var c=f.extend({toc:!0,tocm:!1,tocStartLevel:1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1},b||{}),d=e.$marked,k=new d.Renderer;a=a||[];var l=e.regexs,h=l.atLink,g=l.emoji,m=l.email,p=l.emailLink,q=l.twemoji,n=l.fontAwesome,r=l.editormdLogo,t=l.pageBreak;k.emoji=function(a){a=a.replace(e.regexs.emojiDatetime,function(a){return a.replace(/:/g,"\x26#58;")});var b=a.match(g);if(!b||!c.emoji)return a;for(var d=0,f=b.length;d<f;d++)":+1:"===b[d]&&(b[d]=":\\+1:"),a=a.replace(new RegExp(b[d]),function(a,b){var c=a.match(n),d=a.replace(/:/g,"");if(c)for(d=c.length;0<d;)return d=c[0].replace(/:/g,""),'\x3ci class\x3d"fa '+d+' fa-emoji" title\x3d"'+d.replace("fa-","")+'"\x3e\x3c/i\x3e';else{var c=a.match(r),f=a.match(q);if(c)for(d=c.length;0<d;)return d=c[0].replace(/:/g,""),'\x3ci class\x3d"'+d+'" title\x3d"Editor.md logo ('+d+')"\x3e\x3c/i\x3e';else if(f)for(d=f.length;0<d;)return d=f[0].replace(/:/g,"").replace("tw-",""),'\x3cimg src\x3d"'+e.twemoji.path+d+e.twemoji.ext+'" title\x3d"twemoji-'+d+'" alt\x3d"twemoji-'+d+'" class\x3d"emoji twemoji" /\x3e';else return c="+1"===d?"plus1":d,c="black_large_square"===c?"black_square":c,'\x3cimg src\x3d"'+e.emoji.path+("moon"===c?"waxing_gibbous_moon":c)+e.emoji.ext+'" class\x3d"emoji" title\x3d"\x26#58;'+d+'\x26#58;" alt\x3d"\x26#58;'+d+'\x26#58;" /\x3e'}});return a};k.atLink=function(a){h.test(a)&&(c.atLink&&(a=a.replace(m,function(a,b,c,d){return a.replace(/@/g,"_#_\x26#64;_#_")}),a=a.replace(h,function(a,b){return'\x3ca href\x3d"'+e.urls.atLinkBase+""+b+'" title\x3d"\x26#64;'+b+'" class\x3d"at-link"\x3e'+a+"\x3c/a\x3e"}).replace(/_#_&#64;_#_/g,"@")),c.emailLink&&(a=a.replace(p,function(a,b,c,d,e){return!b&&0>f.inArray(e,"jpg jpeg png gif webp ico icon pdf".split(" "))?'\x3ca href\x3d"mailto:'+a+'"\x3e'+a+"\x3c/a\x3e":a})));return a};k.link=function(a,b,c){if(this.options.sanitize){try{var d=decodeURIComponent(unescape(a)).replace(/[^\w:]/g,"").toLowerCase()}catch(y){return""}if(0===d.indexOf("javascript:"))return""}a='\x3ca href\x3d"'+a+'"';if(h.test(b)||h.test(c))return b&&(a+=' title\x3d"'+b.replace(/@/g,"\x26#64;")),a+'"\x3e'+c.replace(/@/g,"\x26#64;")+"\x3c/a\x3e";b&&(a+=' title\x3d"'+b+'"');return a+("\x3e"+c+"\x3c/a\x3e")};k.heading=function(b,c,d){d=b;var e=/\s*\<a\s*href\=\"(.*)\"\s*([^\>]*)\>(.*)\<\/a\>\s*/;if(e.test(b)){var f=[];b=b.split(/\<a\s*([^\>]+)\>([^\>]*)\<\/a\>/);for(var k=0,g=b.length;k<g;k++)f.push(b[k].replace(/\s*href\=\"(.*)\"\s*/g,""));b=f.join(" ")}b=x(b);f=b.toLowerCase().replace(/[^\w]+/g,"-");f={text:b,level:c,slug:f};k=/^[\u4e00-\u9fa5]+$/.test(b)?escape(b).replace(/\%/g,""):b.toLowerCase().replace(/[^\w]+/g,"-");a.push(f);f="\x3ch"+c+' id\x3d"h'+c+"-"+this.options.headerPrefix+k+'"\x3e';f=f+('\x3ca name\x3d"'+b+'" class\x3d"reference-link"\x3e\x3c/a\x3e')+'\x3cspan class\x3d"header-link octicon octicon-link"\x3e\x3c/span\x3e'+(e?this.atLink(this.emoji(d)):this.atLink(this.emoji(b)));return f+="\x3c/h"+c+"\x3e"};k.pageBreak=function(a){t.test(a)&&c.pageBreak&&(a='\x3chr style\x3d"page-break-after:always;" class\x3d"page-break editormd-page-break" /\x3e');return a};k.paragraph=function(a){var b=/\$\$(.*)\$\$/g.test(a),d=/^\$\$(.*)\$\$$/.test(a),f=d?' class\x3d"'+e.classNames.tex+'"':"",k=c.tocm?/^(\[TOC\]|\[TOCM\])$/.test(a):/^\[TOC\]$/.test(a),g=/^\[TOCM\]$/.test(a);a=!d&&b?a.replace(/(\$\$([^\$]*)\$\$)+/g,function(a,b){return'\x3cspan class\x3d"'+e.classNames.tex+'"\x3e'+b.replace(/\$/g,"")+"\x3c/span\x3e"}):d?a.replace(/\$/g,""):a;b='\x3cdiv class\x3d"markdown-toc editormd-markdown-toc"\x3e'+a+"\x3c/div\x3e";return k?g?'\x3cdiv class\x3d"editormd-toc-menu"\x3e'+b+"\x3c/div\x3e\x3cbr/\x3e":b:t.test(a)?this.pageBreak(a):"\x3cp"+f+"\x3e"+this.atLink(this.emoji(a))+"\x3c/p\x3e\n"};k.code=function(a,b,c){return"seq"===b||"sequence"===b?'\x3cdiv class\x3d"sequence-diagram"\x3e'+a+"\x3c/div\x3e":"flow"===b?'\x3cdiv class\x3d"flowchart"\x3e'+a+"\x3c/div\x3e":"math"===b||"latex"===b||"katex"===b?'\x3cp class\x3d"'+e.classNames.tex+'"\x3e'+a+"\x3c/p\x3e":d.Renderer.prototype.code.apply(this,arguments)};k.tablecell=function(a,b){var c=b.header?"th":"td";return(b.align?"\x3c"+c+' style\x3d"text-align:'+b.align+'"\x3e':"\x3c"+c+"\x3e")+this.atLink(this.emoji(a))+"\x3c/"+c+"\x3e\n"};k.listitem=function(a){return c.taskList&&/^\s*\[[x\s]\]\s*/.test(a)?(a=a.replace(/^\s*\[\s\]\s*/,'\x3cinput type\x3d"checkbox" class\x3d"task-list-item-checkbox" /\x3e ').replace(/^\s*\[x\]\s*/,'\x3cinput type\x3d"checkbox" class\x3d"task-list-item-checkbox" checked disabled /\x3e '),'\x3cli style\x3d"list-style: none;"\x3e'+this.atLink(this.emoji(a))+"\x3c/li\x3e"):"\x3cli\x3e"+this.atLink(this.emoji(a))+"\x3c/li\x3e"};return k};e.markdownToCRenderer=function(a,b,c,d){var e="",f=0,h=this.classPrefix;d=d||1;for(var g=0,m=a.length;g<m;g++){var p=a[g].text,q=a[g].level;q<d||(e=q>f?e+"":q<f?e+Array(f-q+2).join("\x3c/ul\x3e\x3c/li\x3e"):e+"\x3c/ul\x3e\x3c/li\x3e",e+='\x3cli\x3e\x3ca class\x3d"toc-level-'+q+'" href\x3d"#'+p+'" level\x3d"'+q+'"\x3e'+p+"\x3c/a\x3e\x3cul\x3e",f=q)}a=b.find(".markdown-toc");1>a.length&&"false"===b.attr("previewContainer")&&(a='\x3cdiv class\x3d"markdown-toc '+h+'markdown-toc"\x3e\x3c/div\x3e',b.html(c?'\x3cdiv class\x3d"'+h+'toc-menu"\x3e'+a+"\x3c/div\x3e":a),a=b.find(".markdown-toc"));c&&a.wrap('\x3cdiv class\x3d"'+h+'toc-menu"\x3e\x3c/div\x3e\x3cbr/\x3e');a.html('\x3cul class\x3d"markdown-toc-list"\x3e\x3c/ul\x3e').children(".markdown-toc-list").html(e.replace(/\r?\n?\<ul\>\<\/ul\>/g,""));return a};e.tocDropdownMenu=function(a,b){b=b||"Table of Contents";var c=400,d=a.find("."+this.classPrefix+"toc-menu");d.each(function(){var a=f(this),d=a.children(".markdown-toc"),e='\x3ca href\x3d"javascript:;" class\x3d"toc-menu-btn"\x3e\x3ci class\x3d"fa fa-angle-down"\x3e\x3c/i\x3e'+b+"\x3c/a\x3e",g=d.children("ul"),m=g.find("li");d.append(e);m.first().before("\x3cli\x3e\x3ch1\x3e"+b+' \x3ci class\x3d"fa fa-angle-down"\x3e\x3c/i\x3e\x3c/h1\x3e\x3c/li\x3e');a.mouseover(function(){g.show();m.each(function(){var a=f(this),b=a.children("ul");""===b.html()&&b.remove();if(0<b.length&&""!==b.html()){var d=a.children("a").first();1>d.children(".fa").length&&d.append(f('\x3ci class\x3d"fa fa-angle-down"\x3e\x3c/i\x3e').css({"float":"right",paddingTop:"4px"}))}a.mouseover(function(){b.css("z-index",c).show();c+=1}).mouseleave(function(){b.hide()})})}).mouseleave(function(){g.hide()})});return d};e.filterHTMLTags=function(a,b){"string"!==typeof a&&(a=new String(a));if("string"!==typeof b)return a;for(var c=b.split("|"),d=c[0].split(","),e=c[1],c=0,l=d.length;c<l;c++){var h=d[c];a=a.replace(new RegExp("\x3cs*"+h+"s*([^\x3e]*)\x3e([^\x3e]*)\x3cs*/"+h+"s*\x3e","igm"),"")}"undefined"!==typeof e&&(d=/\<(\w+)\s*([^\>]*)\>([^\>]*)\<\/(\w+)\>/ig,a="*"===e?a.replace(d,function(a,b,c,d,e){return"\x3c"+b+"\x3e"+d+"\x3c/"+e+"\x3e"}):"on*"===e?a.replace(d,function(a,b,c,d,e){b=f("\x3c"+b+"\x3e"+d+"\x3c/"+e+"\x3e");a=f(a)[0].attributes;var g={};f.each(a,function(a,b){'"'!==b.nodeName&&(g[b.nodeName]=b.nodeValue)});f.each(g,function(a){0===a.indexOf("on")&&delete g[a]});b.attr(g);a="undefined"!==typeof b[1]?f(b[1]).text():"";return b[0].outerHTML+a}):a.replace(d,function(a,b,c,d){var g=e.split(","),h=f(a);h.html(d);f.each(g,function(a){h.attr(g[a],null)});return h[0].outerHTML}));return a};e.markdownToHTML=function(a,b){e.$marked=marked;var c=f("#"+a),d=c.settings=f.extend(!0,{gfm:!0,toc:!0,tocm:!1,tocStartLevel:1,tocTitle:"\u76ee\u5f55",tocDropdown:!1,tocContainer:"",markdown:"",markdownSourceCode:!1,htmlDecode:!1,autoLoadKaTeX:!0,pageBreak:!0,atLink:!0,emailLink:!0,tex:!1,taskList:!1,emoji:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0},b||{}),k=c.find("textarea");1>k.length&&(c.append("\x3ctextarea\x3e\x3c/textarea\x3e"),k=c.find("textarea"));var l=""===d.markdown?k.val():d.markdown,h=[],g={renderer:e.markedRenderer(h,{toc:d.toc,tocm:d.tocm,tocStartLevel:d.tocStartLevel,taskList:d.taskList,emoji:d.emoji,tex:d.tex,pageBreak:d.pageBreak,atLink:d.atLink,emailLink:d.emailLink,flowChart:d.flowChart,sequenceDiagram:d.sequenceDiagram,previewCodeHighlight:d.previewCodeHighlight}),gfm:d.gfm,tables:!0,breaks:!0,pedantic:!1,sanitize:d.htmlDecode?!1:!0,smartLists:!0,smartypants:!0},l=new String(l),g=marked(l,g),g=e.filterHTMLTags(g,d.htmlDecode);d.markdownSourceCode?k.text(l):k.remove();c.addClass("markdown-body "+this.classPrefix+"html-preview").append(g);l=""!==d.tocContainer?f(d.tocContainer):c;""!==d.tocContainer&&l.attr("previewContainer",!1);d.toc&&(c.tocContainer=this.markdownToCRenderer(h,l,d.tocDropdown,d.tocStartLevel),(d.tocDropdown||0<c.find("."+this.classPrefix+"toc-menu").length)&&this.tocDropdownMenu(c,d.tocTitle),""!==d.tocContainer&&c.find(".editormd-toc-menu, .editormd-markdown-toc").remove());d.previewCodeHighlight&&(c.find("pre").addClass("prettyprint linenums"),prettyPrint());e.isIE8||(d.flowChart&&c.find(".flowchart").flowChart(),d.sequenceDiagram&&c.find(".sequence-diagram").sequenceDiagram({theme:"simple"}));if(d.tex){var m=function(){c.find("."+e.classNames.tex).each(function(){var a=f(this);katex.render(a.html().replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e"),a[0]);a.find(".katex").css("font-size","1.6em")})};!d.autoLoadKaTeX||e.$katex||e.kaTeXLoaded?m():this.loadKaTeX(function(){e.$katex=katex;e.kaTeXLoaded=!0;m()})}c.getMarkdown=function(){return k.val()};return c};e.themes=["default","dark"];e.previewThemes=["default","dark"];e.editorThemes="default 3024-day 3024-night ambiance ambiance-mobile base16-dark base16-light blackboard cobalt eclipse elegant erlang-dark lesser-dark mbo mdn-like midnight monokai neat neo night paraiso-dark paraiso-light pastel-on-dark rubyblue solarized the-matrix tomorrow-night-eighties twilight vibrant-ink xq-dark xq-light".split(" ");e.loadPlugins={};e.loadFiles={js:[],css:[],plugin:[]};e.loadPlugin=function(a,b,c){b=b||function(){};this.loadScript(a,function(){e.loadFiles.plugin.push(a);b()},c)};e.loadCSS=function(a,b,c){c=c||"head";b=b||function(){};var d=document.createElement("link");d.type="text/css";d.rel="stylesheet";d.onload=d.onreadystatechange=function(){e.loadFiles.css.push(a);b()};d.href=a+".css";"head"===c?document.getElementsByTagName("head")[0].appendChild(d):document.body.appendChild(d)};e.isIE="Microsoft Internet Explorer"==navigator.appName;e.isIE8=e.isIE&&"8."==navigator.appVersion.match(/8./i);e.loadScript=function(a,b,c){c=c||"head";b=b||function(){};var d=null,d=document.createElement("script");d.id=a.replace(/[\./]+/g,"-");d.type="text/javascript";d.src=a+".js";e.isIE8?d.onreadystatechange=function(){!d.readyState||"loaded"!==d.readyState&&"complete"!==d.readyState||(d.onreadystatechange=null,e.loadFiles.js.push(a),b())}:d.onload=function(){e.loadFiles.js.push(a);b()};"head"===c?document.getElementsByTagName("head")[0].appendChild(d):document.body.appendChild(d)};e.katexURL={css:"//cdn.bootcss.com/KaTeX/0.3.0/katex.min",js:"//cdn.bootcss.com/KaTeX/0.3.0/katex.min"};e.kaTeXLoaded=!1;e.loadKaTeX=function(a){e.loadCSS(e.katexURL.css,function(){e.loadScript(e.katexURL.js,a||function(){})})};e.lockScreen=function(a){f("html,body").css("overflow",a?"hidden":"")};e.createDialog=function(a){a=f.extend(!0,{name:"",width:420,height:240,title:"",drag:!0,closed:!0,content:"",mask:!0,maskStyle:{backgroundColor:"#fff",opacity:.1},lockScreen:!0,footer:!0,buttons:!1},a);var b=this,c=this.editor,d=e.classPrefix,k=(new Date).getTime(),l=""===a.name?d+"dialog-"+k:a.name,k=e.mouseOrTouch,h='\x3cdiv class\x3d"'+d+"dialog "+l+'"\x3e';""!==a.title&&(h+='\x3cdiv class\x3d"'+d+'dialog-header"'+(a.drag?' style\x3d"cursor: move;"':"")+"\x3e",h+='\x3cstrong class\x3d"'+d+'dialog-title"\x3e'+a.title+"\x3c/strong\x3e",h+="\x3c/div\x3e");a.closed&&(h+='\x3ca href\x3d"javascript:;" class\x3d"fa fa-close '+d+'dialog-close"\x3e\x3c/a\x3e');h+='\x3cdiv class\x3d"'+d+'dialog-container"\x3e'+a.content;if(a.footer||"string"===typeof a.footer)h+='\x3cdiv class\x3d"'+d+'dialog-footer"\x3e'+("boolean"===typeof a.footer?"":a.footer)+"\x3c/div\x3e";c.append(h+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+d+"dialog-mask "+d+'dialog-mask-bg"\x3e\x3c/div\x3e')+('\x3cdiv class\x3d"'+d+"dialog-mask "+d+'dialog-mask-con"\x3e\x3c/div\x3e')+"\x3c/div\x3e");var g=c.find("."+l);g.lockScreen=function(c){a.lockScreen&&(f("html,body").css("overflow",c?"hidden":""),b.resize());return g};g.showMask=function(){a.mask&&c.find("."+d+"mask").css(a.maskStyle).css("z-index",e.dialogZindex-1).show();return g};g.hideMask=function(){a.mask&&c.find("."+d+"mask").hide();return g};g.loading=function(a){g.find("."+d+"dialog-mask")[a?"show":"hide"]();return g};g.lockScreen(!0).showMask();g.show().css({zIndex:e.dialogZindex,border:e.isIE8?"1px solid #ddd":"",width:"number"===typeof a.width?a.width+"px":a.width,height:"number"===typeof a.height?a.height+"px":a.height});l=function(){g.css({top:(f(window).height()-g.height())/2+"px",left:(f(window).width()-g.width())/2+"px"})};l();f(window).resize(l);g.children("."+d+"dialog-close").bind(k("click","touchend"),function(){g.hide().lockScreen(!1).hideMask()});if("object"===typeof a.buttons){var l=g.footer=g.find("."+d+"dialog-footer"),m;for(m in a.buttons){var h=a.buttons[m],p=d+m+"-btn";l.append('\x3cbutton class\x3d"'+d+"btn "+p+'"\x3e'+h[0]+"\x3c/button\x3e");h[1]=f.proxy(h[1],g);l.children("."+p).bind(k("click","touchend"),h[1])}}if(""!==a.title&&a.drag){var q,n;m=g.children("."+d+"dialog-header");a.mask||m.bind(k("click","touchend"),function(){e.dialogZindex+=2;g.css("z-index",e.dialogZindex)});m.mousedown(function(a){a=a||window.event;q=a.clientX-parseInt(g[0].style.left);n=a.clientY-parseInt(g[0].style.top);document.onmousemove=v});var r=function(a){a.removeClass(d+"user-unselect").off("selectstart")},t=function(a){a.addClass(d+"user-unselect").on("selectstart",function(a){return!1})},v=function(a){a=a||window.event;var b;b=parseInt(g[0].style.left);var c=parseInt(g[0].style.top);0<=b?b+g.width()<=f(window).width()?b=a.clientX-q:(b=f(window).width()-g.width(),document.onmousemove=null):(b=0,document.onmousemove=null);0<=c?a=a.clientY-n:(a=0,document.onmousemove=null);document.onselectstart=function(){return!1};t(f("body"));t(g);g[0].style.left=b+"px";g[0].style.top=a+"px"};document.onmouseup=function(){r(f("body"));r(g);document.onselectstart=null;document.onmousemove=null};m.touchDraggable=function(){var a=null;this.bind("touchstart",function(b){b=b.originalEvent;var c=f(this).parent().position();a={x:b.changedTouches[0].pageX-c.left,y:b.changedTouches[0].pageY-c.top}}).bind("touchmove",function(b){b.preventDefault();b=b.originalEvent;f(this).parent().css({top:b.changedTouches[0].pageY-a.y,left:b.changedTouches[0].pageX-a.x})})};m.touchDraggable()}e.dialogZindex+=2;return g};e.mouseOrTouch=function(a,b){b=b||"touchend";var c=a||"click";try{document.createEvent("TouchEvent"),c=b}catch(d){}return c};e.dateFormat=function(a){a=a||"";var b=function(a){return 10>a?"0"+a:a},c=new Date,d=c.getFullYear(),e=d.toString().slice(2,4),f=b(c.getMonth()+1),h=b(c.getDate()),g=c.getDay(),m=b(c.getHours()),p=b(c.getMinutes()),q=b(c.getSeconds()),b=b(c.getMilliseconds()),n="",n=e+"-"+f+"-"+h,r=d+"-"+f+"-"+h,t=m+":"+p+":"+q;switch(a){case "UNIX Time":n=c.getTime();break;case "UTC":n=c.toUTCString();break;case "yy":n=e;break;case "year":case "yyyy":n=d;break;case "month":case "mm":n=f;break;case "cn-week-day":case "cn-wd":n="\u661f\u671f"+"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[g];break;case "week-day":case "wd":n="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")[g];break;case "day":case "dd":n=h;break;case "hour":case "hh":n=m;break;case "min":case "ii":n=p;break;case "second":case "ss":n=q;break;case "ms":n=b;break;case "yy-mm-dd":break;case "yyyy-mm-dd":n=r;break;case "yyyy-mm-dd h:i:s ms":case "full + ms":n=r+" "+t+" "+b;break;default:n=r+" "+t}return n};return e}});